/*! For license information please see startServer.js.LICENSE.txt */
!function(Q,U){if("object"==typeof exports&&"object"==typeof module)module.exports=U(require("cors"),require("express"));else if("function"==typeof define&&define.amd)define(["cors","express"],U);else{var B="object"==typeof exports?U(require("cors"),require("express")):U(Q.cors,Q.express);for(var F in B)("object"==typeof exports?exports:Q)[F]=B[F]}}(global,((__WEBPACK_EXTERNAL_MODULE__1761__,__WEBPACK_EXTERNAL_MODULE__2806__)=>(()=>{var __webpack_modules__={7147:Q=>{"use strict";Q.exports=require("fs")},1761:Q=>{"use strict";Q.exports=__WEBPACK_EXTERNAL_MODULE__1761__},2806:Q=>{"use strict";Q.exports=__WEBPACK_EXTERNAL_MODULE__2806__},2517:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";eval("\n\nvar fs = __webpack_require__(7147);\nfunction exists(fileUrl, callback) {\n  fs.stat(fileUrl, function (error, stat) {\n    if (error) {\n      callback(false);\n    } else {\n      callback(true, stat.size);\n    }\n  });\n}\nvar _promiseCounter = 0;\nvar _promisesObj = {};\nfunction _generateRequestId() {\n  var ts = new Date().getTime();\n  var requestId;\n  _promiseCounter++;\n  requestId = _promiseCounter + '-' + ts;\n  return requestId;\n}\nfunction processCmd(cmd, args) {\n  var requestId = _generateRequestId();\n  var promise = new Promise(function (resolve, reject) {\n    _promisesObj[requestId] = {\n      resolve: resolve,\n      reject: reject\n    };\n  });\n  var request = {};\n  request.requestId = requestId;\n  request.cmd = cmd;\n  request.args = args;\n  process.send(request);\n  return promise;\n}\nfunction processMessage(data) {\n  var requestId = data.requestId;\n  var error = data.error;\n  var result = data.result;\n  var promiseObj = _promisesObj[requestId + ''];\n  function resolve(result) {\n    promiseObj.resolve(result);\n  }\n  if (promiseObj) {\n    if (data.status === 'OK') {\n      resolve(result);\n    } else {\n      promiseObj.reject(error);\n    }\n    delete _promisesObj[requestId];\n  }\n}\n\n/**\n *\n * @private\n * @returns {void}\n */\nfunction _attachEvents() {\n  process.on('message', processMessage);\n}\n\n/**\n* ContentRoute\n* @param {object} app - express server instance\n* @constructor\n*/\n\nfunction ContentRoute(app, routeName) {\n  var manifestInfo = {};\n  _attachEvents();\n\n  /*------------------------------------------------------------------------------------------*/\n\n  // ROUTER MANAGEMENT\n\n  /*------------------------------------------------------------------------------------------*/\n\n  /**\n   * Handles get movies/manifestId\n   */\n  app.get('/' + routeName + '/:id/*', function (req, res) {\n    var manifestId = req.params['id'];\n\n    // send back file data function\n    var sendFile = function sendFile(file) {\n      var options = {\n        dotfiles: 'deny'\n      };\n      res.sendFile(file, options, function (err) {\n        if (err && err.status) {\n          // error to open file => remove saved info (maybe moved)\n          delete manifestInfo[manifestId];\n          res.status(err.status).end();\n        }\n      });\n    };\n    var seekIfNeeded = function seekIfNeeded(folder) {\n      var file = folder + '/' + manifestId + '/' + req.params[0];\n      exists(file, function (exists) {\n        if (exists) {\n          // fragment exists on disk, let's check if it is not being downloaded\n          processCmd('is_downloading', {\n            manifest: manifestId,\n            file: file\n          }).then(function () {\n            sendFile(file);\n          })[\"catch\"](function () {\n            return res.status(404).end();\n          });\n        } else {\n          // fragment doesn't on disk, ask to download it\n          processCmd('perform_seek', {\n            manifest: manifestId,\n            file: file\n          }).then(function () {\n            sendFile(file);\n          })[\"catch\"](function () {\n            return res.status(404).end();\n          });\n        }\n      });\n    };\n    var getFile = function getFile(info) {\n      if (info && info.status === 'FINISHED') {\n        // if file has status finished, no need to check if fragment is being downloaded\n        var file = info.folder + '/' + manifestId + '/' + req.params[0];\n        exists(file, function (exists) {\n          if (exists) {\n            // fragment exists => send data\n            sendFile(file);\n          } else {\n            // fragment doesn't exists => 404 and remove cached data\n            delete manifestInfo[manifestId];\n            return res.status(404).end();\n          }\n        });\n      } else {\n        // file is not finished, let's perform seek if needed\n        seekIfNeeded(info.folder);\n      }\n    };\n\n    // check if info have been already saved for the manifest\n    if (manifestInfo[manifestId]) {\n      getFile(manifestInfo[manifestId]);\n    } else {\n      // no info for manifest id, asks main process to get manifest info\n      processCmd('get_info', {\n        manifest: manifestId\n      }).then(function (result) {\n        manifestInfo[manifestId] = result;\n        getFile(manifestInfo[manifestId]);\n      })[\"catch\"](function () {\n        delete manifestInfo[manifestId];\n        return res.status(404).send('Cannot find manifest');\n      });\n    }\n  });\n}\nmodule.exports = ContentRoute;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMsRUFBRTtNQUM1QlksT0FBTyxDQUFFaEIsWUFBWSxDQUFDSSxVQUFVLENBQUMsQ0FBQztJQUNwQyxDQUFDLE1BQU07TUFDTDtNQUNBeEIsVUFBVSxDQUFDLFVBQVUsRUFBRTtRQUFDa0MsUUFBUSxFQUFFVjtNQUFVLENBQUMsQ0FBQyxDQUMzQ1csSUFBSSxDQUFDLFVBQUN2QixNQUFNLEVBQUs7UUFDbEJRLFlBQVksQ0FBQ0ksVUFBVSxDQUFDLEdBQUdaLE1BQU07UUFDakN3QixPQUFPLENBQUVoQixZQUFZLENBQUNJLFVBQVUsQ0FBQyxDQUFDO01BQ3BDLENBQUMsQ0FBQyxTQUNNLENBQUMsWUFBWTtRQUNuQixPQUFRSixZQUFZLENBQUNJLFVBQVUsQ0FBQztRQUNoQyxPQUFPRCxHQUFHLENBQUNULE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0wsSUFBSSxDQUFDLHNCQUFzQixDQUFDO01BQ3JELENBQUMsQ0FBQztJQUNKO0VBQ0YsQ0FBQyxDQUFDO0FBQ0o7QUFFQTZCLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHdEIsWUFBWSIsInNvdXJjZXMiOlsid2VicGFjazovL2Rvd25zdHJlYW0tZWxlY3Ryb24vLi9hcGkvc2VydmVyL2NvbnRlbnRSb3V0ZS5qcz84NjY4Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCBmcyA9IHJlcXVpcmUoXCJmc1wiKTtcblxuZnVuY3Rpb24gZXhpc3RzIChmaWxlVXJsLCBjYWxsYmFjaykge1xuICBmcy5zdGF0KGZpbGVVcmwsIGZ1bmN0aW9uIChlcnJvciwgc3RhdCkge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgY2FsbGJhY2soZmFsc2UpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNhbGxiYWNrKHRydWUsIHN0YXQuc2l6ZSk7XG4gICAgfVxuICB9KTtcbn1cblxubGV0IF9wcm9taXNlQ291bnRlciA9IDA7XG5sZXQgX3Byb21pc2VzT2JqID0ge307XG5cbmZ1bmN0aW9uIF9nZW5lcmF0ZVJlcXVlc3RJZCAoKSB7XG4gIGxldCB0cyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICBsZXQgcmVxdWVzdElkO1xuICBfcHJvbWlzZUNvdW50ZXIrKztcbiAgcmVxdWVzdElkID0gX3Byb21pc2VDb3VudGVyICsgJy0nICsgdHM7XG4gIHJldHVybiByZXF1ZXN0SWQ7XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NDbWQgKGNtZCwgYXJncykge1xuICBjb25zdCByZXF1ZXN0SWQgPSBfZ2VuZXJhdGVSZXF1ZXN0SWQoKTtcbiAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBfcHJvbWlzZXNPYmpbcmVxdWVzdElkXSA9IHtcbiAgICAgIHJlc29sdmU6IHJlc29sdmUsXG4gICAgICByZWplY3Q6IHJlamVjdFxuICAgIH07XG4gIH0pO1xuICBsZXQgcmVxdWVzdCA9IHt9O1xuICByZXF1ZXN0LnJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgcmVxdWVzdC5jbWQgPSBjbWQ7XG4gIHJlcXVlc3QuYXJncyA9IGFyZ3M7XG4gIHByb2Nlc3Muc2VuZChyZXF1ZXN0KTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NNZXNzYWdlIChkYXRhKSB7XG4gIGNvbnN0IHJlcXVlc3RJZCA9IGRhdGEucmVxdWVzdElkO1xuICBjb25zdCBlcnJvciA9IGRhdGEuZXJyb3I7XG4gIGNvbnN0IHJlc3VsdCA9IGRhdGEucmVzdWx0O1xuICBjb25zdCBwcm9taXNlT2JqID0gX3Byb21pc2VzT2JqW3JlcXVlc3RJZCArICcnXTtcblxuICBmdW5jdGlvbiByZXNvbHZlIChyZXN1bHQpIHtcbiAgICBwcm9taXNlT2JqLnJlc29sdmUocmVzdWx0KTtcbiAgfVxuXG4gIGlmIChwcm9taXNlT2JqKSB7XG4gICAgaWYgKGRhdGEuc3RhdHVzID09PSAnT0snKSB7XG4gICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByb21pc2VPYmoucmVqZWN0KGVycm9yKTtcbiAgICB9XG4gICAgZGVsZXRlKF9wcm9taXNlc09ialtyZXF1ZXN0SWRdKTtcbiAgfVxufVxuXG4vKipcbiAqXG4gKiBAcHJpdmF0ZVxuICogQHJldHVybnMge3ZvaWR9XG4gKi9cbmZ1bmN0aW9uIF9hdHRhY2hFdmVudHMgKCkge1xuICBwcm9jZXNzLm9uKCdtZXNzYWdlJywgcHJvY2Vzc01lc3NhZ2UpO1xufVxuXG4vKipcbiogQ29udGVudFJvdXRlXG4qIEBwYXJhbSB7b2JqZWN0fSBhcHAgLSBleHByZXNzIHNlcnZlciBpbnN0YW5jZVxuKiBAY29uc3RydWN0b3JcbiovXG5cbmZ1bmN0aW9uIENvbnRlbnRSb3V0ZSAoYXBwLCByb3V0ZU5hbWUpIHtcblxuICBsZXQgbWFuaWZlc3RJbmZvID0ge307XG5cbiAgX2F0dGFjaEV2ZW50cygpO1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvLyBST1VURVIgTUFOQUdFTUVOVFxuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvKipcbiAgICogSGFuZGxlcyBnZXQgbW92aWVzL21hbmlmZXN0SWRcbiAgICovXG4gIGFwcC5nZXQoJy8nICsgcm91dGVOYW1lICsgJy86aWQvKicsIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuXG4gICAgbGV0IG1hbmlmZXN0SWQgPSByZXEucGFyYW1zWydpZCddO1xuXG4gICAgLy8gc2VuZCBiYWNrIGZpbGUgZGF0YSBmdW5jdGlvblxuICAgIGxldCBzZW5kRmlsZSA9IGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgZG90ZmlsZXM6ICdkZW55J1xuICAgICAgfVxuICAgICAgcmVzLnNlbmRGaWxlKGZpbGUsIG9wdGlvbnMsIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgaWYgKGVyciAmJiBlcnIuc3RhdHVzKSB7XG4gICAgICAgICAgLy8gZXJyb3IgdG8gb3BlbiBmaWxlID0+IHJlbW92ZSBzYXZlZCBpbmZvIChtYXliZSBtb3ZlZClcbiAgICAgICAgICBkZWxldGUgbWFuaWZlc3RJbmZvW21hbmlmZXN0SWRdO1xuICAgICAgICAgIHJlcy5zdGF0dXMoZXJyLnN0YXR1cykuZW5kKCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgbGV0IHNlZWtJZk5lZWRlZCAgPSBmdW5jdGlvbiAoZm9sZGVyKSB7XG4gICAgICBsZXQgZmlsZSA9IGZvbGRlciArICcvJyArIG1hbmlmZXN0SWQgKyAnLycgKyByZXEucGFyYW1zWzBdO1xuICAgICAgZXhpc3RzKGZpbGUsIChleGlzdHMpID0+IHtcbiAgICAgICAgaWYgKGV4aXN0cykge1xuICAgICAgICAgIC8vIGZyYWdtZW50IGV4aXN0cyBvbiBkaXNrLCBsZXQncyBjaGVjayBpZiBpdCBpcyBub3QgYmVpbmcgZG93bmxvYWRlZFxuICAgICAgICAgIHByb2Nlc3NDbWQoJ2lzX2Rvd25sb2FkaW5nJywge21hbmlmZXN0OiBtYW5pZmVzdElkLCBmaWxlOiBmaWxlfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHNlbmRGaWxlKGZpbGUpXG4gICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmVuZCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGZyYWdtZW50IGRvZXNuJ3Qgb24gZGlzaywgYXNrIHRvIGRvd25sb2FkIGl0XG4gICAgICAgICAgcHJvY2Vzc0NtZCgncGVyZm9ybV9zZWVrJywge21hbmlmZXN0OiBtYW5pZmVzdElkLCBmaWxlOiBmaWxlfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHNlbmRGaWxlKGZpbGUpXG4gICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmVuZCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIGxldCBnZXRGaWxlID0gZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgIGlmIChpbmZvICYmIGluZm8uc3RhdHVzID09PSAnRklOSVNIRUQnKSB7XG4gICAgICAgIC8vIGlmIGZpbGUgaGFzIHN0YXR1cyBmaW5pc2hlZCwgbm8gbmVlZCB0byBjaGVjayBpZiBmcmFnbWVudCBpcyBiZWluZyBkb3dubG9hZGVkXG4gICAgICAgIGxldCBmaWxlID0gaW5mby5mb2xkZXIgKyAnLycgKyBtYW5pZmVzdElkICsgJy8nICsgcmVxLnBhcmFtc1swXTtcbiAgICAgICAgZXhpc3RzKGZpbGUsIChleGlzdHMpID0+IHtcbiAgICAgICAgICBpZiAoZXhpc3RzKSB7XG4gICAgICAgICAgICAvLyBmcmFnbWVudCBleGlzdHMgPT4gc2VuZCBkYXRhXG4gICAgICAgICAgICBzZW5kRmlsZShmaWxlKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBmcmFnbWVudCBkb2Vzbid0IGV4aXN0cyA9PiA0MDQgYW5kIHJlbW92ZSBjYWNoZWQgZGF0YVxuICAgICAgICAgICAgZGVsZXRlICBtYW5pZmVzdEluZm9bbWFuaWZlc3RJZF07XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmVuZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBmaWxlIGlzIG5vdCBmaW5pc2hlZCwgbGV0J3MgcGVyZm9ybSBzZWVrIGlmIG5lZWRlZFxuICAgICAgICBzZWVrSWZOZWVkZWQoIGluZm8uZm9sZGVyKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjaGVjayBpZiBpbmZvIGhhdmUgYmVlbiBhbHJlYWR5IHNhdmVkIGZvciB0aGUgbWFuaWZlc3RcbiAgICBpZiAobWFuaWZlc3RJbmZvW21hbmlmZXN0SWRdKSB7XG4gICAgICBnZXRGaWxlKCBtYW5pZmVzdEluZm9bbWFuaWZlc3RJZF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBubyBpbmZvIGZvciBtYW5pZmVzdCBpZCwgYXNrcyBtYWluIHByb2Nlc3MgdG8gZ2V0IG1hbmlmZXN0IGluZm9cbiAgICAgIHByb2Nlc3NDbWQoJ2dldF9pbmZvJywge21hbmlmZXN0OiBtYW5pZmVzdElkfSlcbiAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICBtYW5pZmVzdEluZm9bbWFuaWZlc3RJZF0gPSByZXN1bHQ7XG4gICAgICAgIGdldEZpbGUoIG1hbmlmZXN0SW5mb1ttYW5pZmVzdElkXSk7XG4gICAgICB9KVxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgIG1hbmlmZXN0SW5mb1ttYW5pZmVzdElkXTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKCdDYW5ub3QgZmluZCBtYW5pZmVzdCcpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IENvbnRlbnRSb3V0ZTtcbiJdLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJleGlzdHMiLCJmaWxlVXJsIiwiY2FsbGJhY2siLCJzdGF0IiwiZXJyb3IiLCJzaXplIiwiX3Byb21pc2VDb3VudGVyIiwiX3Byb21pc2VzT2JqIiwiX2dlbmVyYXRlUmVxdWVzdElkIiwidHMiLCJEYXRlIiwiZ2V0VGltZSIsInJlcXVlc3RJZCIsInByb2Nlc3NDbWQiLCJjbWQiLCJhcmdzIiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicmVxdWVzdCIsInByb2Nlc3MiLCJzZW5kIiwicHJvY2Vzc01lc3NhZ2UiLCJkYXRhIiwicmVzdWx0IiwicHJvbWlzZU9iaiIsInN0YXR1cyIsIl9hdHRhY2hFdmVudHMiLCJvbiIsIkNvbnRlbnRSb3V0ZSIsImFwcCIsInJvdXRlTmFtZSIsIm1hbmlmZXN0SW5mbyIsImdldCIsInJlcSIsInJlcyIsIm1hbmlmZXN0SWQiLCJwYXJhbXMiLCJzZW5kRmlsZSIsImZpbGUiLCJvcHRpb25zIiwiZG90ZmlsZXMiLCJlcnIiLCJlbmQiLCJzZWVrSWZOZWVkZWQiLCJmb2xkZXIiLCJtYW5pZmVzdCIsInRoZW4iLCJnZXRGaWxlIiwiaW5mbyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///2517\n")},2942:(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{eval("var express = __webpack_require__(2806);\nvar cors = __webpack_require__(1761);\n(function () {\n  process.send({\n    cmd: 'log',\n    log: 'Starting HTTP server'\n  });\n  var server = express();\n  server.use(cors());\n\n  // listen for messages\n  process.on('message', function (data) {\n    // handles init message\n    if (data.cmd === 'init') {\n      // add content route\n      __webpack_require__(2517)(server, data.routeName);\n      // start http server\n      server.listen(data.port, function () {\n        // http server is listening => send back listening port\n        process.send({\n          cmd: 'listening_port',\n          port: data.port\n        });\n      });\n    }\n  });\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjk0Mi5qcyIsIm1hcHBpbmdzIjoiQUFBQSxJQUFNQSxPQUFPLEdBQUdDLG1CQUFPLENBQUMsSUFBUyxDQUFDO0FBQ2xDLElBQU1DLElBQUksR0FBR0QsbUJBQU8sQ0FBQyxJQUFNLENBQUM7QUFFM0IsYUFBWTtFQUVYRSxPQUFPLENBQUNDLElBQUksQ0FBQztJQUFDQyxHQUFHLEVBQUUsS0FBSztJQUNWQyxHQUFHLEVBQUU7RUFBc0IsQ0FBQyxDQUFDO0VBQzNDLElBQUlDLE1BQU0sR0FBR1AsT0FBTyxDQUFDLENBQUM7RUFDdEJPLE1BQU0sQ0FBQ0MsR0FBRyxDQUFDTixJQUFJLENBQUMsQ0FBQyxDQUFDOztFQUVsQjtFQUNBQyxPQUFPLENBQUNNLEVBQUUsQ0FBQyxTQUFTLEVBQUUsVUFBVUMsSUFBSSxFQUFFO0lBRXBDO0lBQ0EsSUFBSUEsSUFBSSxDQUFDTCxHQUFHLEtBQUssTUFBTSxFQUFFO01BQ3ZCO01BQ0FKLG1CQUFPLENBQUMsSUFBZ0IsQ0FBQyxDQUFDTSxNQUFNLEVBQUVHLElBQUksQ0FBQ0MsU0FBUyxDQUFDO01BQ2pEO01BQ0FKLE1BQU0sQ0FBQ0ssTUFBTSxDQUFDRixJQUFJLENBQUNHLElBQUksRUFBRSxZQUFZO1FBQ25DO1FBQ0FWLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDO1VBQUNDLEdBQUcsRUFBRSxnQkFBZ0I7VUFBRVEsSUFBSSxFQUFFSCxJQUFJLENBQUNHO1FBQUksQ0FBQyxDQUFDO01BQ3hELENBQUMsQ0FBQztJQUNKO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxFQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb3duc3RyZWFtLWVsZWN0cm9uLy4vYXBpL3NlcnZlci9zdGFydFNlcnZlci5qcz81ZmE2Il0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gIHByb2Nlc3Muc2VuZCh7Y21kOiAnbG9nJyxcbiAgICAgICAgICAgICAgICBsb2c6ICdTdGFydGluZyBIVFRQIHNlcnZlcid9KTtcbiAgbGV0IHNlcnZlciA9IGV4cHJlc3MoKTtcbiAgc2VydmVyLnVzZShjb3JzKCkpO1xuXG4gIC8vIGxpc3RlbiBmb3IgbWVzc2FnZXNcbiAgcHJvY2Vzcy5vbignbWVzc2FnZScsIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAvLyBoYW5kbGVzIGluaXQgbWVzc2FnZVxuICAgIGlmIChkYXRhLmNtZCA9PT0gJ2luaXQnKSB7XG4gICAgICAvLyBhZGQgY29udGVudCByb3V0ZVxuICAgICAgcmVxdWlyZSgnLi9jb250ZW50Um91dGUnKShzZXJ2ZXIsIGRhdGEucm91dGVOYW1lKTtcbiAgICAgIC8vIHN0YXJ0IGh0dHAgc2VydmVyXG4gICAgICBzZXJ2ZXIubGlzdGVuKGRhdGEucG9ydCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBodHRwIHNlcnZlciBpcyBsaXN0ZW5pbmcgPT4gc2VuZCBiYWNrIGxpc3RlbmluZyBwb3J0XG4gICAgICAgIHByb2Nlc3Muc2VuZCh7Y21kOiAnbGlzdGVuaW5nX3BvcnQnLCBwb3J0OiBkYXRhLnBvcnR9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59KCkpO1xuIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiY29ycyIsInByb2Nlc3MiLCJzZW5kIiwiY21kIiwibG9nIiwic2VydmVyIiwidXNlIiwib24iLCJkYXRhIiwicm91dGVOYW1lIiwibGlzdGVuIiwicG9ydCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2942\n")}},__webpack_module_cache__={};function __webpack_require__(Q){var U=__webpack_module_cache__[Q];if(void 0!==U)return U.exports;var B=__webpack_module_cache__[Q]={exports:{}};return __webpack_modules__[Q](B,B.exports,__webpack_require__),B.exports}var __webpack_exports__=__webpack_require__(2942);return __webpack_exports__})()));